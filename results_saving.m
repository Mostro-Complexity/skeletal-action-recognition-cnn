function [] = results_saving(results_dir, total_accuracy,...
    cw_accuracy, avg_total_accuracy, avg_cw_accuracy, confusion_matrices,...
        avg_confusion_matrix, action_names) %#ok<INUSL>
    
    mkdir(results_dir);

    save ([results_dir, '/classification_results.mat'],...
        'total_accuracy',...
        'cw_accuracy',...
        'avg_total_accuracy',...
        'avg_cw_accuracy',...
        'confusion_matrices',...
        'avg_confusion_matrix',...
        'action_names');

    % save confusion matrices as excel files.
    for i = 1:length(confusion_matrices)
        xlswrite([results_dir, '/confusion_matrices.xlsx'], confusion_matrices{i},...
            ['confusion_matrix', num2str(i)])
    end
    xlswrite([results_dir, '/confusion_matrices.xlsx'], action_names,...
            'text_labels')

    xlswrite([results_dir, '/avg_confusion_matrix.xlsx'], avg_confusion_matrix)
    xlswrite([results_dir, '/avg_confusion_matrix.xlsx'], action_names,...
            'text_labels')
        

end

